# Backlog: DB-07 - 驗證資料庫遷移腳本的通用性

- **Epic:** 會員系統與多工作區功能導入
- **狀態:** To Do
- **優先級:** Highest
- **估算 (Story Points):** 5

---

### 使用者故事 (User Story)

**身為** 一位負責維運與部署的 DevOps 工程師，
**我想要** 確保資料庫遷移 (Alembic) 腳本能夠在兩種關鍵場景下都能完美執行：一個是帶有歷史資料的現存資料庫，另一個是全新的、空白的資料庫，
**以便** 我能充滿信心地將升級流程自動化，並應用於正式部署、測試環境建置，以及新開發者的本機環境初始化。

---

### 驗收標準 (Acceptance Criteria)

1.  **全新資料庫遷移測試通過：**
    -   [ ] 存在一個自動化測試流程（例如，一個 shell script）。
    -   [ ] 該流程可以啟動一個全新的、空白的資料庫容器。
    -   [ ] 在此空資料庫上，從頭 (`base`) 到尾 (`head`) 執行 `alembic upgrade` 指令能成功完成，無任何錯誤。
    -   [ ] 遷移後的資料庫結構 (schema) 與 SQLAlchemy 模型定義完全一致。

2.  **現有資料庫遷移測試通過：**
    -   [ ] 存在一個自動化測試流程。
    -   [ ] 該流程可以載入一個包含舊結構與模擬資料的資料庫快照。
    -   [ ] 在此資料庫上執行 `alembic upgrade head` 指令能成功完成，無任何錯誤。
    -   [ ] 所有在 `DB-06` 中定義的遺留資料都被正確地歸檔到「遺留工作區」。

3.  **效能基準測試通過：**
    -   [ ] 測試環境包含合理數量的模擬資料（至少 1000 筆 papers, 10000 筆 sentences）。
    -   [ ] 遷移過程的執行時間被記錄，並在可接受範圍內（< 10 分鐘）。
    -   [ ] 透過 `docker logs` 可以追蹤遷移進度與資源使用狀況。

---

### 技術筆記 (Technical Notes)

-   此任務的核心是**建立可重複執行的測試流程**。建議使用 `docker-compose` 來管理測試用的資料庫實例。
-   這個 Backlog 的完成，是宣告整個「第一階段：資料庫模型重新設計」成功與否的最終指標。
-   它驗證了 `DB-01` 到 `DB-06` 所有工作的正確性與完整性。 